


## Introduction:
The purpose of this script is to take tab-limited text files containing information related to significant Gene Ontology terms associated with two effects of interest (_phenotype_ and _environment_) for each category (BP - Biological Process; MF - Molecular function; and CC - Cellular component). The input files containing information related to significantly enriched GO terms were generated by the R package [topGO](https://bioconductor.org/packages/release/bioc/html/topGO.html). The current script generates Euler plots for significant GO terms identified in both effect groups for each GO category.
The script outputs PDF files for each plot and saves everything as an R object.

First step, load library required for plotting:

```{r, message = FALSE}
##install.packages("eulerr")
library(eulerr)
library(ggplot2)
```

Next, load input data:

```{r, message = FALSE}
phenotype_dir <- "results/strutta_drerio/output_50ks_phenotype_effect_contr_env/"
## 1) phenotype_effect_contr_env
phenotype_bp <- read.table(file = paste(phenotype_dir,
                                        "BP_input_for_plot.txt",
                                        sep = ""),
                           header = TRUE)
phenotype_mf <- read.table(file = paste(phenotype_dir,
                                        "MF_input_for_plot.txt",
                                        sep = ""),
                           header = TRUE)
phenotype_cc <- read.table(file = paste(phenotype_dir,
                                        "CC_input_for_plot.txt",
                                        sep = ""),
                           header = TRUE)
## 2) env_effect_contr_phen
environment_dir <- "results/strutta_drerio/output_50ks_env_effect_contr_phen/"

environment_bp <- read.table(file = paste(environment_dir,
                                        "BP_input_for_plot.txt",
                                        sep = ""),
                           header = TRUE)
environment_mf <- read.table(file = paste(environment_dir,
                                        "MF_input_for_plot.txt",
                                        sep = ""),
                           header = TRUE)
environment_cc <- read.table(file = paste(environment_dir,
                                        "CC_input_for_plot.txt",
                                        sep = ""),
                           header = TRUE)

```

Create a list of comparisons to plot:

```{r, message = FALSE}
bp_vendiagram <- euler(combinations = list("Phenotype BP-GO terms" = phenotype_bp$Term,
                                        "Osmotic environment BP-GO terms" = environment_bp$Term),
                                        shape = "ellipse")
mf_vendiagram <- euler(combinations = list("Phenotype MF-GO terms" = phenotype_mf$Term,
                                        "Osmotic environment MF-GO terms" = environment_mf$Term),
                                        shape = "ellipse")
cc_vendiagram <- euler(combinations = list("Phenotype CC-GO terms" = phenotype_cc$Term,
                                        "Osmotic environment CC-GO" = environment_cc$Term),
                                        shape = "ellipse")
```

Plot Venn diagram

Select all code and run together at the same time to save plot.
It won't work it execute lines of code indepedently.

```{r, message = FALSE}
pdf(file = "results/euler_plot_bp.pdf",
     width = 6,
     height = 4)
plot(bp_vendiagram,
     quantities = TRUE,
     edges = TRUE)
dev.off()

pdf(file = "results/euler_plot_mf.pdf",
     width = 6,
     height = 4)
plot(mf_vendiagram,
     quantities = TRUE,
     edges = TRUE)
dev.off()

pdf(file = "results/euler_plot_cc.pdf",
     width = 6,
     height = 4)
plot(cc_vendiagram,
     quantities = TRUE,
     edges = TRUE)
dev.off()
```

For now, save everything:

```{r, message = FALSE}
save.image(file = "eulerr_output_liver.RData")
```
